<!DOCTYPE html>
<html>
<head>
    <title>博客统计</title>
    <meta charset="utf-8">
</head>
<body>

</body>
<script src="js/d3.js" charset="utf-8"></script>
<script src="js/jquery-2.1.0.js" charset="utf-8"></script>
<script type="text/javascript">
    var visits_by_month = [{"month":1,"visits":1081},{"month":2,"visits":195},
        {"month":3,"visits":461},{"month":4,"visits":461},{"month":5,"visits":556},
        {"month":6,"visits":526},{"month":7,"visits":645},{"month":8,"visits":562},
        {"month":9,"visits":503},{"month":10,"visits":592},{"month":11,"visits":764},
        {"month":12,"visits":819}];

    var w = 400;
    var h = 200;
    var padding = 10;

    var x_scale = d3.scale.linear()
            .domain([1,13])
            .range([0,w]);

    var y_scale = d3.scale.linear()
            .domain([0,
            d3.max(visits_by_month,function(d){
                return d.visits;
            })])
            .range([0,h-2*padding]);
    var width = Math.round(x_scale(2)-0-padding);

    $(document).ready(function(){
        var svg = d3.select("body").append("svg").attr({
            "width": w,
            "height":h
        });
        svg.selectAll("rect")
                .data(visits_by_month)
                .enter()
                .append("rect")
                .attr({
                    x: function(d){
                        return Math.round(x_scale(d.month));
                    },
                    y: function(d){
                        return Math.round(h- y_scale(d.visits));
                    },
                    width: width,
                    height: function(d){
                        return Math.round(y_scale(d.visits));
                    },
                    fill: "blue"
                });
        svg.selectAll("text")
                .data(visits_by_month)
                .enter()
                .append("text")
                .text(function(d){
                    return d.visits;
                })
                .attr({
                    x: function(d){
                        return Math.round(x_scale(d.month))+width/2;
                    },
                    y: function(d){
                        return Math.round(h- y_scale(d.visits))-padding;
                    },
                    fill: "red",
                    "font-size":"10pt",
                    "text-anchor": "middle"
                });
    });
</script>
</html>