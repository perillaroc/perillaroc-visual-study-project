<!DOCTYPE html>
<html>
<head>
    <title>选择排序</title>
</head>
<body>
<div class="plot_container">

</div>
</body>
<script src="/public/js/jquery-2.1.0.js" charset="utf-8"></script>
<script src="/public/js/d3.js" charset="utf-8"></script>
<script type="text/javascript">
    $(document).ready(function(){
        var width =  600;
        var height = 600;
        var margin = 50;
        var bar_width = 15;
        var bar_width_step = 20;
        var bar_height_step = 15;

        var svg = d3.select(".plot_container").append("svg")
                .attr("width", width)
                .attr("height", height);

        var total_of_nums = 20;
        var num_array = [];
        for(var i=1;i<=total_of_nums;i++)
        {
            num_array.push(i);
        }
        d3.shuffle(num_array);

        svg.selectAll(".bar")
                .data(num_array)
                .enter()
                .append("rect")
                .attr({
                    x:function(d,i){
                        return i*bar_width_step;
                    },
                    y:function(d,i){
                        return (total_of_nums-d)*bar_height_step;
                    },
                    width:bar_width,
                    height:function(d,i){
                        return d*bar_height_step;
                    },
                    fill:"blue",
                    class:"bar"
                });


        var i = 0;
        var timer;
        one_step();
        function one_step(){
            var num = num_array[i];
            var pos = i;
            for(var j=i+1;j<num_array.length;j++)
            {
                if(num_array[j]<num_array[pos])
                    pos = j;
            }

            // TODO: swap
            var temp = num_array[pos];
            num_array[pos] = num_array[i];
            num_array[i] = temp;

            svg.selectAll(".bar")
                .data(num_array)
                .attr({
                    y:function(d,i){
                        return (total_of_nums-d)*bar_height_step;
                    },
                    height:function(d,i){
                        return d*bar_height_step;
                    },
                    fill:function(d,index){
                        if(index<=i)
                            return "green";
                        else
                            return "gray";
                    }
                });

            i++;
            if(i<num_array.length)
                timer = setTimeout(one_step,500);
        }

    });
</script>
</html>